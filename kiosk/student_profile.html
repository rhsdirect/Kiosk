<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      p.login100-form-title {
        font-family: "Times New Roman", Times, serif;
        color: red;
      }
    </style>

    <title>Kiosk â€¢ Student Profile</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="icon" type="image/png" href="../assets/img/favicon.ico" />

    <link
      rel="stylesheet"
      type="text/css"
      href="../vendor/bootstrap/css/bootstrap.min.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../fonts/iconic/css/material-design-iconic-font.min.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../vendor/animate/animate.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../vendor/css-hamburgers/hamburgers.min.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../vendor/animsition/css/animsition.min.css"
    />
    <link rel="stylesheet" type="text/css" href="../css/iziToast.css" />

    <link
      rel="stylesheet"
      type="text/css"
      href="../vendor/select2/select2.min.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../vendor/daterangepicker/daterangepicker.css"
    />

    <link rel="stylesheet" type="text/css" href="../css/util.css" />
    <link rel="stylesheet" type="text/css" href="../css/main.css" />
    <link rel="stylesheet" type="text/css" href="../css/jquery-ui.css" />

    <style type="text/css" rel="stylesheet">
      footer {
        background: rgb(8, 87, 5);
        padding: 20px;
      }

      footer p {
        color: #fff;
      }

      @import url("https://fonts.googleapis.com/css?family=Exo:400,700");

      * {
        margin: 0px;
        padding: 0px;
      }

      body {
        font-family: "Exo", sans-serif;
      }

      .context {
        width: 100%;
        position: absolute;
        top: 50vh;
      }

      .context h1 {
        text-align: center;
        color: #fff;
        font-size: 50px;
      }

      .area {
        /* background: #4e54c8; */
        /* background: #325dad; */
        /* background: -webkit-linear-gradient(to left, #8f94fb, #4e54c8); */
        width: 100%;
        height: 100vh;
      }

      .circles {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        /* background: url("/assets/img/rhs_building.jpeg");
        background-repeat: no-repeat;
        background-size: cover; */
      }

      .circles li {
        position: absolute;
        display: block;
        list-style: none;
        width: 20px;
        height: 20px;
        background: rgba(255, 255, 255, 0.2);
        animation: animate 25s linear infinite;
        bottom: -150px;
      }

      .circles li:nth-child(1) {
        left: 25%;
        width: 80px;
        height: 80px;
        animation-delay: 0s;
      }

      .circles li:nth-child(2) {
        left: 10%;
        width: 20px;
        height: 20px;
        animation-delay: 2s;
        animation-duration: 12s;
      }

      .circles li:nth-child(3) {
        left: 70%;
        width: 20px;
        height: 20px;
        animation-delay: 4s;
      }

      .circles li:nth-child(4) {
        left: 40%;
        width: 60px;
        height: 60px;
        animation-delay: 0s;
        animation-duration: 18s;
      }

      .circles li:nth-child(5) {
        left: 65%;
        width: 20px;
        height: 20px;
        animation-delay: 0s;
      }

      .circles li:nth-child(6) {
        left: 75%;
        width: 110px;
        height: 110px;
        animation-delay: 3s;
      }

      .circles li:nth-child(7) {
        left: 35%;
        width: 150px;
        height: 150px;
        animation-delay: 7s;
      }

      .circles li:nth-child(8) {
        left: 50%;
        width: 25px;
        height: 25px;
        animation-delay: 15s;
        animation-duration: 45s;
      }

      .circles li:nth-child(9) {
        left: 20%;
        width: 15px;
        height: 15px;
        animation-delay: 2s;
        animation-duration: 35s;
      }

      .circles li:nth-child(10) {
        left: 85%;
        width: 150px;
        height: 150px;
        animation-delay: 0s;
        animation-duration: 11s;
      }

      @keyframes animate {
        0% {
          transform: translateY(0) rotate(0deg);
          opacity: 1;
          border-radius: 0;
        }

        100% {
          transform: translateY(-1000px) rotate(720deg);
          opacity: 0;
          border-radius: 50%;
        }
      }
    </style>
  </head>

  <body id="loginPage" class="area" style="overflow: hidden !important">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg custom-nav">
      <div class="container-fluid">
        <!-- Toggle button -->
        <!-- <button
                    class="navbar-toggler"
                    type="button"
                    data-mdb-toggle="collapse"
                    data-mdb-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                  >
                    <i class="fa-bars text-light"></i>
                  </button> -->

        <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
          <ul
            class="navbar-nav mr-auto mt-2 mt-lg-0"
            style="display: flex; align-items: center; justify-content: center"
          >
            <!-- <ul class="navbar-nav me-auto d-flex flex-row mt-3 mt-lg-0"> -->
            <li
              class="nav-item text-center mx-lg-5 active"
              style="margin: auto 0"
            >
              <a class="navbar-brand" href="#">
                <img
                  src="../assets/img/rizal2.png"
                  width="100"
                  height="100"
                  class="d-inline-block align-top rizal-logo"
                  alt=""
                />
              </a>
            </li>
            <li class="nav-item text-center">
              <div class="rizal-text">
                <!-- <i class="fa fa-home fa-lg mb-1"></i> -->
                STUDENT PROFILE
              </div>
            </li>
          </ul>
        </div>

        <div class="form-inline my-2 my-lg-0">
          <ul
            class="navbar-nav mr-auto mt-2 mt-lg-0 rizal-text-right"
            style="display: flex; align-items: center; justify-content: center"
          >
            <!-- <ul class="navbar-nav me-auto d-flex flex-row mt-3 mt-lg-0"> -->

            <!-- <li class="nav-item text-center mx-2 mx-lg-3">
              <a class="nav-link" href="index.html">
                Home</a
              >
            </li> -->

            <li
              class="nav-item text-center mx-2 mx-lg-3 logout"
              style="width: 120px"
            >
              <a class="nav-link logout-link" id="logout"> LOGOUT </a>
            </li>

            <!--
            <li class="nav-item text-center mx-2 mx-lg-3">
              <a class="nav-link" href="#">
                Request
              </a>
            </li>

            <li class="nav-item text-center mx-2 mx-lg-3">
              <a class="nav-link" href="login.html">
                Login
              </a>
            </li> -->
          </ul>
        </div>
      </div>
    </nav>
    <!-- Navbar -->

    <div class="container-fluid h-100 container-content text-center">
      <!-- <div class="bg-login"></div> -->

      <div class="container p-4" id="student-profile">
        <div class="row">
          <div class="col-3">
            <img
              src="/assets/img/default-avatar.png"
              alt="Default Avatar"
              class="img-avatar"
              id="student-id-image"
              style="width: 200px"
            />
          </div>
          <div class="col-9">
            <div class="containe-fluid">
              <div class="row">
                <div class="accordion" id="accordionExample">
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingOne">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseOne"
                        aria-expanded="true"
                        aria-controls="collapseOne"
                      >
                        Name:
                      </div>
                    </h1>
                    <div
                      id="collapseOne"
                      class="accordion-collapse collapse show"
                      aria-labelledby="headingOne"
                    >
                      <div class="accordion-body details">
                        <span id="name"
                          ><i class="fa fa-spin fa-spinner"></i
                        ></span>

                        <!-- <div class="col-12">
                          <div class="col-content">
                            <div
                              class="icon-wrapper"
                              style="position: relative"
                            >
                              <span style="position: absolute; top: 0; right: 0"
                                ><i
                                  class="hidden-details fa fa-eye-slash"
                                  details="guardian"
                                ></i
                              ></span>
                            </div>
                            <div class="col-title">Guardian:</div>
                            <span
                              id="guardian"
                              class="showDetail"
                              style="display: none"
                              >---</span
                            >
                            <span id="guardian-hidden" class="hideDetail"
                              >---</span
                            >
                          </div> -->
                      </div>
                    </div>
                  </div>

                  <!-- Year -->
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingYear">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseYear"
                        aria-expanded="true"
                        aria-controls="collapseYear"
                      >
                        Year/Section:
                      </div>
                    </h1>
                    <div
                      id="collapseYear"
                      class="accordion-collapse collapse"
                      aria-labelledby="headingYear"
                    >
                      <div class="accordion-body details">
                        <span id="year">---</span>
                      </div>
                    </div>
                  </div>

                  <!-- Phone Number -->
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingNumber">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseNumber"
                        aria-expanded="true"
                        aria-controls="collapseNumber"
                      >
                        Phone Number:
                      </div>
                    </h1>
                    <div
                      id="collapseNumber"
                      class="accordion-collapse collapse"
                      aria-labelledby="headingNumber"
                    >
                      <div class="accordion-body details">
                        <span id="phone">---</span>
                      </div>
                    </div>
                  </div>

                  <!-- Status -->
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingStatus">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseStatus"
                        aria-expanded="true"
                        aria-controls="collapseStatus"
                      >
                        Status:
                      </div>
                    </h1>
                    <div
                      id="collapseStatus"
                      class="accordion-collapse collapse"
                      aria-labelledby="headingStatus"
                    >
                      <div class="accordion-body details">
                        <span
                          id="status"
                          style="color: #00d828; font-weight: bold"
                          >---</span
                        >
                      </div>
                    </div>
                  </div>

                  <!-- Guardian -->
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingGuardian">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseGuardian"
                        aria-expanded="true"
                        aria-controls="collapseGuardian"
                      >
                        Guardian:
                      </div>
                    </h1>
                    <div
                      id="collapseGuardian"
                      class="accordion-collapse collapse"
                      aria-labelledby="headingGuardian"
                    >
                      <div class="accordion-body details">
                        <span id="guardian">---</span>
                      </div>
                    </div>
                  </div>

                  <!-- Requirement -->
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingRequirement">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseRequirement"
                        aria-expanded="true"
                        aria-controls="collapseRequirement"
                      >
                        Requirements:
                      </div>
                    </h1>
                    <div
                      id="collapseRequirement"
                      class="accordion-collapse collapse show"
                      aria-labelledby="headingRequirement"
                    >
                      <div class="accordion-body details">
                        <span>
                          <ul>
                            <li>Form 137 (Grade 7) - to be followed up</li>
                          </ul></span
                        >
                      </div>
                    </div>
                  </div>

                  <!-- Incident Report -->
                  <div class="accordion-item">
                    <h1 class="accordion-header" id="headingIncident">
                      <div
                        class="accordion-button student-title"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseIncident"
                        aria-expanded="true"
                        aria-controls="collapseIncident"
                      >
                        Incident Report:
                      </div>
                    </h1>
                    <div
                      id="collapseIncident"
                      class="accordion-collapse collapse"
                      aria-labelledby="headingIncident"
                    >
                      <div class="accordion-body details">
                        <span>
                          <ul>
                            <li>N/A</li>
                          </ul></span
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row other-details"></div>
      </div>
    </div>

    <script src="../vendor/jquery/jquery-3.2.1.min.js"></script>

    <script src="../vendor/animsition/js/animsition.min.js"></script>

    <script src="../vendor/bootstrap/js/popper.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <script src="../vendor/select2/select2.min.js"></script>
    <script src="../script/iziToast.js" defer></script>

    <script src="../vendor/daterangepicker/moment.min.js"></script>
    <script src="../vendor/daterangepicker/daterangepicker.js"></script>

    <script type="module" src="../script/app.js"></script>
    <script src="../vendor/countdowntime/countdowntime.js"></script>

    <script src="../js/main.js"></script>
    <script src="../script/jquery-ui.js"></script>
    <script src="../js/sweetalert2.all.min.js"></script>
    <script src="../js/login.js"></script>

    <script>
      $(document).ready(() => {
        const connectedRef = _ref();
        const onValue = _onValue();
        const get = _get();
        const child = _child();
        const onChildAdded = _childAdded();
        const ref2 = _ref2();
        const push = _push();
        const update = _update();

        const notifResult = _ref2("notification");
        onValue(notifResult, (snapshot) => {
          if (snapshot.exists()) {
            const data = snapshot.val();
            iziToast.destroy();

            for (let item in data) {
              if (!data[item].isRead) {
                iziToast.info({
                  title: "You have a notification",
                  // timeout: 10000,
                  timeout: false,
                  message: `Click to view notification`,
                  onOpening: function (instance, toast) {
                    toast.addEventListener("click", function () {
                      Swal.fire({
                        title: "NOTIFICATION",
                        icon: "info",
                        html: `${data[item].msg}`,
                        confirmButtonText: "OKAY",
                        // timer: 10000,
                        // timerProgressBar: true,
                        willClose: (e) => {},
                        confirmButtonColor: "#00bf63",
                        showCancelButton: false,
                        width: "80%"
                      }).then((result) => {
                        // window.location.href = "";
                        const notifResult = _ref2("notification");
                        const userResult = _ref2("user");
                        const updates = {};
                        const userUpdates = {};
                        let e = $("#required-email").val();
                        updates[item + "/" + "isRead"] = true;
                        updates[item + "/" + "email"] = e;
                        userUpdates[data[item].lrn + "/" + "email"] = e;
                        update(notifResult, updates);
                        update(userResult, userUpdates);

                        // Loop to Document also to update the document's email addresses
                        const docResult = _ref2("document");
                        get(child(docResult, "/")).then((s)=>{
                          if(s.exists()){
                            let d = s.val();

                            for(let docu in d){
                              if(d[docu].id == data[item].lrn){
                                const docUpdates = {};
                                // let e = $("#required-email").val() == undefined ? "" : $("#required-email").val();

                                docUpdates[docu + "/" + "email"] = e;
                                update(docResult, docUpdates);
                              }
                            }
                          }

                        })
                      });
                    });
                  },
                });
              }
            }
            // console.log(data);
          }
        });

        $(".hidden-details").on("click", (e) => {
          // console.log();
          let details = $(e.target);
          let hiddenForm = $(details).parent().parent().parent();
          let showDetail = $(hiddenForm).find(".showDetail");
          let hideDetail = $(hiddenForm).find(".hideDetail");

          // Hidden
          if (details.hasClass("fa-eye-slash")) {
            $(showDetail).delay(500).fadeIn();
            $(hideDetail).fadeOut();

            // $("#guardian").fadeIn();
            // $("#guardian-hidden").fadeOut();
            details.removeClass("fa-eye-slash");
            details.addClass("fa-eye");
          } else {
            $(showDetail).fadeOut();
            $(hideDetail).delay(500).fadeIn();

            details.addClass("fa-eye-slash");
            details.removeClass("fa-eye");
          }
        });

        let selectedId = sessionStorage.getItem("loggedIn");
        StudentIDURL(selectedId)
          .then((url) => {
            $("#student-id-image").attr("src", url);
            console.log("123");
          })
          .catch(() => {});
      });
    </script>
  </body>
</html>
